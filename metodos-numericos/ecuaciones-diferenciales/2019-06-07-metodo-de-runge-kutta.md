---
title: Método de Runge-Kutta
---
## Algoritmo

$$
y_{i+1}=y_i+\frac{1}{6}(k_1+2k_2+2k_3,k_4)h
$$
donde:
$$ k_1 = f(x_i,y_i) $$
$$ k_2 = f(x_i+\frac{1}{2}h, y_i + \frac{1}{2} k_1h) $$
$$ k_3 = f(x_i+\frac{1}{2}h, y_i+\frac{1}{2}k_2h) $$
$$ k_4 = f(x_i+h, y_i+k_3h) $$

## Ejercicio 1

Resuelve el problema de valor inicial $\frac{dy}{dx} = 4e^{0.8x} - 0.5y$ en $[0,4]$ con valores iniciales para $x = 0$ y $y = 2$, con un tamaño de paso $h = 1$

| i   | $x_i$ | $y_i$      | $k_1$      | $k_2$      | $k_3$      | $k_4$      |
| --- | ----- | ---------- | ---------- | ---------- | ---------- | ---------- |
| 0   | 0     | 2          | 3.000000   | 4.217299   | 3.912974   | 5.945677   |
| 1   | 1     | 6.201037   | 5.801645   | 10.830056  | 9.572954   | 14.025653  |
| 2   | 2     | 16.306590  | 11.658835  | 25.641516  | 22.145845  | 32.019783  |
| 3   | 3     | 39.515480  | 24.334965  | 58.694846  | 50.104876  | 72.077683  |
| 4   | 4     | 91.850829  | 52.204706  | 132.341761 | 112.307497 | 161.238851 |
| 5   | 5     | 208.974508 | 113.905346 | 296.327138 | 250.721690 | 359.680825 |
| 6   | 6     | 470.255146 | 250.914097 | 661.360443 | 558.748857 | 801.331201 |

$Y_{0+1}= 2 + \frac{1}{6} (3 +2(4.127299) + 2(3.912974) + 5.945677)(1) = 6.201037$

| Operaciones para primer "intervalo"                                                                          | Resultado de K |
| ------------------------------------------------------------------------------------------------------------ | -------------- |
| $K_1 = f(0,2) = 4e^{0.8(0)} - 0.5(2) =$                                                                      | 3              |
| $K_2 = f(0 + \frac{1}{2}(1), 2+\frac{1}{2}(3)(1) ) = f(0.5, 3.5) = 4e^{0.8(0.5)}-0.5(3.5) =$                 | 4.217299       |
| $K_3 = f(0 + \frac{1}{2}(1), 2+\frac{1}{2}(4.217299)(1)) = f(0.5, 4.103650) = 4e^{0.8(0.5)}-0.5(4.183650) =$ | 3.912974       |
| $K_4 = f(0 + 1, 2 + 3.912974(1)) = f(1, 5.912974) = 4e^{0.8(1)}-0.5(5.912974) =$                             | 5.945677       |

## Ejercicio 2

Si la resistencia del aire es proporcional al cuadrado de la velocidad instantánea, entonces la velocidad $v$ de una masa $m$ que se deja caer desde cierta altura se determina por:
$$
m \frac{dv}{dt} = mg - kv^2,\ \ \ k>0
$$
Sea $v(0) = 0$, $k = 0.125$, $m = 5 slugs$ y $g = 32$ pies/$s^2$. Use el método de RK4 con $h = 1$ para aproximar la velocidad $v$(5).
$$
5 \frac{dv}{dt} = 5(32) - 0.125v^2\\
\frac{dv}{dt} = \frac{5(32) - 0.125v^2}{5}\\
\frac{dv}{dt} = 32 - 0.025v^2\\
f(t) = 32 - 0.025v^2
$$

| $i$  | $X_i$ | $Y_i$       | $K_1$     | $K_2$     | $K_3$     | $K_4$     |
| ---- | ----- | ----------- | --------- | --------- | --------- | --------- |
| 0    | 0     | 0           | 32.000000 | 25.600000 | 27.904000 | 12.534170 |
| 1    | 1     | 25.25702827 | 16.052063 | 4.305948  | 13.217294 | -5.006837 |
| 2    | 2     | 32.93898006 | 4.875590  | 0.712095  | 4.286029  | -2.642532 |
| 3    | 3     | 34.97719755 | 1.414891  | 0.165156  | 1.270303  | -0.847033 |
| 4    | 4     | 35.55032704 | 0.404356  | 0.043959  | 0.365275  | -0.248261 |
| 5    | 5     | 35.71275425 | 0.114980  | 0.012241  | 0.104050  | -0.071086 |
| 6    | 6     | 35.7588334  | 0.032646  | 0.003455  | 0.029557  | -0.020223 |
| 7    | 7     | 35.77190794 | 0.009265  | 0.000979  | 0.008390  | -0.005743 |
| 8    | 8     | 35.77561787 | 0.002629  | 0.000278  | 0.002381  | -0.001630 |

### Solución analítica

$$
\frac{dv}{dt} + \frac{1}{40}v^2 = 32\\
L \{ \frac{dv}{dt} + \frac{1}{40}v^2\} = L \{32\}\\
SV(s) - v(0) + \frac{1}{40} V^2(s) = \frac{32}{S}\\
SV(s) - 0 + \frac{1}{40}V(s) = \frac{32}{S}\\
V(s)(\frac{1}{40}V(s)+S)  = \frac{32}{S}
$$
